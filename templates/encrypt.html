{% extends "base.html" %}
{% block title %}Encrypt file{% endblock %}
{% block content %}
     {% for message in get_flashed_messages() %}
          <div class="alert alert-danger alert-dismissible fade show" role="alert">
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
          </button>
          <strong>Warning!  </strong>{{message}}
        </div>
    {% endfor %}
    <div class="container-fluid mx-auto">
        <div class="row d-flex justify-content-center">
            <div class="col-xl-7 col-lg-8 col-md-9 col-11 text-center">
                <div class="p-5">
                     <h1>Encrypt your file</h1>
                </div>
                <div class="media">
                    <div class="media-left">
                        <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" fill="currentColor" class="bi bi-key-fill" viewBox="0 0 16 16">
                            <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                        </svg>
                    </div>
                    <div class="media-body my-5">
                        <h4 class="media-heading">Encrypt file</h4>
                        This feature allow user to encrypt a file. The user can select file with the "File" input box. The file is encypted with a random symmetric key. This key is encrypted by RSA assymetric key, provided by the user in the "Public key" input box.
                        This encypted symmetic key is then put in the output file header.
                        Lastly the file is encrypted by AES-GCM block cipher. The data needed for AES-GCM decryption are also included in the file header.
                        Output file is in base64 encoding and can be downloaded by clicking on the link "Download file".
                    </div>
                </div>
                <form action="#" method="post" class="was-validated" enctype="multipart/form-data">
                    <div class="mb-3">
                      <label for="public_key" class="form-label">Public key (.pub) :</label>
                      <input class="form-control" type="file" id="public_key" name ="public_key" required>
                        <div class="valid-feedback">
                          Looks good!
                         </div>
                         <div class="invalid-feedback">
                            Please upload your public key.
                         </div>
                    </div>
                    <div class="mb-3">
                      <label for="text_file" class="form-label">File (.txt max: 1GB) :</label>
                      <input class="form-control" type="file" id="text_file" name="text_file" required>
                         <div class="valid-feedback">
                          Looks good!
                        </div>
                        <div class="invalid-feedback">
                            Please upload your file.
                         </div>
                    </div>
                    <div class="mt-3">
                        <div class="row justify-content-center">
                            <div class="form-group col-sm-6">
                                <button class="btn btn-outline-secondary" type="submit">Submit</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}